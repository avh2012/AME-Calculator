<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrated Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(to right, #73a8f0, #7fcaf5);
            color: #333;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input {
            width: 200px;
            margin-bottom: 10px;
            padding: 8px;
            box-sizing: border-box;
        }

        button.calculate {
            padding: 8px 16px;
            background-color: #FF8C00;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }

        button.reset {
            padding: 8px 16px;
            background-color: #f44336;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }

        #result {
            margin-top: 20px;
            font-weight: bold;
        }

        .highlight {
            background-color: yellow;
            color: #333;
        }

        .underline {
            text-decoration: underline;
        }

        .highlight-number {
            font-weight: bold;
            font-style: italic;
            background-color: yellow;
            text-decoration: underline;
        }

        #optionsButton {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            padding: 8px 16px;
            font-size: 14px;
        }

        #optionsList {
            display: none;
            position: absolute;
            top: 40px;
            right: 10px;
            background-color: #ecf0f1;
            border: 1px solid #ddd;
            padding: 8px;
            z-index: 1;
        }

        #optionsList li {
            list-style: none;
            padding: 8px;
            cursor: pointer;
            color: #333;
        }

        #optionsList li:hover {
            background-color: #bdc3c7;
        }

        #subpage {
            display: none;
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            background-color: #FFD700;
        }

        #subpage h2 {
            color: #333;
        }

        #calculateBtnSubpage,
        .reset {
            padding: 8px 16px;
            cursor: pointer;
            margin-top: 10px;
        }

        #calculateBtnSubpage {
            background-color: #FF8C00;
            color: #fff;
            border: none;
        }

        .reset {
            background-color: #f44336;
            color: #fff;
            border: none;
        }

        #melCalculator {
            text-align: center;
            margin: 50px;
            background-color: #98FB98;
            max-width: 400px;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <button id="optionsButton" onclick="toggleOptions()">Options</button>
    <ul id="optionsList">
        <li onclick="showSubpage()">Oil Uplift Calculator</li>
        <li onclick="showMelCalculator()">MEL Calculator</li>
    </ul>

    <label for="uplift_liters">Uplift (liters): </label>
    <input type="number" id="uplift_liters" required>

    <label for="specific_gravity">Specific Gravity (not exceeding 1): </label>
    <input type="number" step="any" id="specific_gravity" required>

    <label for="in_tank_fuel">In-tank Fuel (kilograms): </label>
    <input type="number" step="any" id="in_tank_fuel" required>

    <label for="departure_fuel">Departure Fuel (kilograms): </label>
    <input type="number" step="any" id="departure_fuel" required>

    <button class="calculate" onclick="calculate()">Calculate</button>
    <button class="reset" onclick="resetForm()">Reset</button>

    <div id="result"></div>

    <div id="subpage">
        <h2>OIL UPLIFT CALCULATOR</h2>

        <label for="acHrsAtThisStnSubpage">A/c Hrs at this Stn:</label>
        <input type="number" id="acHrsAtThisStnSubpage" placeholder="HH">
        <input type="number" id="acMinAtThisStnSubpage" placeholder="MM">

        <label for="acHrsAtLastStnSubpage">A/c Hrs at last stn where serviced:</label>
        <input type="number" id="acHrsAtLastStnSubpage" placeholder="HH">
        <input type="number" id="acMinAtLastStnSubpage" placeholder="MM">

        <label for="oilUpliftedSubpage">Oil Uplifted:</label>
        <input type="number" id="oilUpliftedSubpage" placeholder="Enter oil uplifted (qts)">

        <button id="calculateBtnSubpage" onclick="calculateUpliftSubpage()">Calculate Uplift</button>
        <button class="reset" onclick="resetFormSubpage()">Reset</button>

        <div id="resultSubpage"></div>
    </div>

    <div id="melCalculator">
        <h1>MEL Calculator</h1>
        <label for="inputDate">Enter a Date (DD-MM-YYYY):</label>
        <input type="date" id="inputDate" onchange="calculateMelDates()" required>
        <p id="resultMel"></p>
    </div>

    <script>
        function calculate() {
            try {
                var uplift_liters = parseFloat(document.getElementById("uplift_liters").value);
                var specific_gravity = parseFloat(document.getElementById("specific_gravity").value);
                var in_tank_fuel = parseFloat(document.getElementById("in_tank_fuel").value);
                var departure_fuel = parseFloat(document.getElementById("departure_fuel").value);

                if (isNaN(uplift_liters) || isNaN(specific_gravity) || isNaN(in_tank_fuel) || isNaN(departure_fuel)) {
                    throw "Invalid input. Please enter numeric values.";
                }

                var actual_uplift_kg = uplift_liters * specific_gravity;
                var fuel_difference = departure_fuel - in_tank_fuel;

                var discrepancy = ((actual_uplift_kg - fuel_difference) / actual_uplift_kg) * 100;

                var resultElement = document.getElementById("result");
                var utcTime = new Date().toUTCString();
                var timePart = utcTime.split(' ')[4];
                var formattedTime = utcTime.replace(timePart, `<span class="highlight-number">${timePart}</span>`);

                resultElement.innerHTML = `
                    <p>Actual Uplift: <span class="highlight-number">${actual_uplift_kg.toFixed(2)}</span> kilograms</p>
                    <p>Fuel Difference: <span class="highlight-number">${fuel_difference.toFixed(2)}</span> kilograms</p>
                    <p>Discrepancy: ${discrepancy.toFixed(6)}%</p>
                    <p>UTC Time: ${formattedTime}</p>
                `;
            } catch (error) {
                alert(error);
            }
        }

        function resetForm() {
            document.getElementById("result").innerHTML = "";
            document.getElementById("uplift_liters").value = "";
            document.getElementById("specific_gravity").value = "";
            document.getElementById("in_tank_fuel").value = "";
            document.getElementById("departure_fuel").value = "";
        }

        function toggleOptions() {
            var optionsList = document.getElementById("optionsList");
            optionsList.style.display = optionsList.style.display === "none" ? "block" : "none";
        }

        function showSubpage() {
            var subpage = document.getElementById("subpage");
            subpage.style.display = "block";
        }

        function calculateUpliftSubpage() {
            var acHrsAtThisStnSubpage = parseFloat(document.getElementById("acHrsAtThisStnSubpage").value);
            var acMinAtThisStnSubpage = parseFloat(document.getElementById("acMinAtThisStnSubpage").value);
            var acHrsAtLastStnSubpage = parseFloat(document.getElementById("acHrsAtLastStnSubpage").value);
            var acMinAtLastStnSubpage = parseFloat(document.getElementById("acMinAtLastStnSubpage").value);
            var oilUpliftedSubpage = parseFloat(document.getElementById("oilUpliftedSubpage").value);

            if (isNaN(acHrsAtThisStnSubpage) || isNaN(acMinAtThisStnSubpage) || isNaN(acHrsAtLastStnSubpage) || isNaN(acMinAtLastStnSubpage)) {
                alert("Please enter valid numeric values for A/c Hrs and Min.");
                return;
            }

            var totalHrsAtThisStnSubpage = acHrsAtThisStnSubpage + acMinAtThisStnSubpage / 60;
            var totalHrsAtLastStnSubpage = acHrsAtLastStnSubpage + acMinAtLastStnSubpage / 60;
            var acHrsDifferenceSubpage = totalHrsAtThisStnSubpage - totalHrsAtLastStnSubpage;

            var hoursDiffSubpage = Math.floor(Math.abs(acHrsDifferenceSubpage));
            var minutesDiffSubpage = Math.abs(acHrsDifferenceSubpage % 1) * 60;
            var acHrsDiffFormattedSubpage = (acHrsDifferenceSubpage < 0 ? "-" : "") + hoursDiffSubpage.toString().padStart(2, '0') + ":" + minutesDiffSubpage.toFixed(0).padStart(2, '0');

            var BSubpage = hoursDiffSubpage + (minutesDiffSubpage / 60);
            var CalConsumptionRateSubpage = oilUpliftedSubpage / BSubpage;

            var resultElementSubpage = document.getElementById("resultSubpage");
            resultElementSubpage.innerHTML = "<p>A/c Hrs Difference: <span class=\"highlight-number\">" + acHrsDiffFormattedSubpage + "</span></p>" +
                "<p>Cal. Consumption Rate: <span class=\"highlight-number\">" + CalConsumptionRateSubpage.toFixed(6) + "</span></p>";
        }

        function resetFormSubpage() {
            document.getElementById("acHrsAtThisStnSubpage").value = "";
            document.getElementById("acMinAtThisStnSubpage").value = "";
            document.getElementById("acHrsAtLastStnSubpage").value = "";
            document.getElementById("acMinAtLastStnSubpage").value = "";
            document.getElementById("oilUpliftedSubpage").value = "";
            document.getElementById("resultSubpage").innerHTML = "";
        }

        function calculateDate(inputDate, offsetDays) {
            var dateObject = new Date(inputDate);
            dateObject.setDate(dateObject.getDate() + offsetDays);
            return formatDate(dateObject);
        }

        function formatDate(date) {
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();

            day = day < 10 ? '0' + day : day;
            month = month < 10 ? '0' + month : month;

            return `${day}-${month}-${year}`;
        }

        function calculateMelDates() {
            var inputDate = document.getElementById("inputDate").value;

            if (!inputDate) {
                var currentDate = new Date();
                inputDate = formatDate(currentDate);
            }

            var resultCatB = calculateDate(inputDate, 3);
            var resultCatC = calculateDate(inputDate, 10);
            var resultCatD = calculateDate(inputDate, 120);

            var utcTime = new Date().toISOString().split('T')[1].slice(0, 8);

            document.getElementById("resultMel").innerHTML = `
                CAT B (+ 3 Days): ${resultCatB} <br>
                CAT C (+ 10 Days): ${resultCatC} <br>
                CAT D (+ 120 Days): ${resultCatD} <br>
                Current UTC Time: <span id="utcTimeContainer"><span id="utcTime">${utcTime}</span></span>`;
        }

        window.onload = function() {
            calculateMelDates();
        };
    </script>
</body>

</html>
